# MawkNagiosXIPOC Vulnerability Report

This repository contains a Proof of Concept (PoC) for a vulnerability discovered in Nagios XI, which is an enterprise-class monitoring solution. The vulnerability allows for an Authenticated SQL Injection, potentially leading to unauthorized admin account creation and full remote code execution.

## Vulnerability Details

- **Endpoint:** `/nagiosxi//config/monitoringwizard.php`
- **Vulnerability Type:** Authenticated SQL Injection
- **Exploitation Result:** Admin account creation and full remote code execution

## Steps to Reproduce

1. Create a fresh instance of Nagios XI Version 2024R1.01.
2. Access the targeted endpoint `/nagiosxi//config/monitoringwizard.php`.
3. Create a user with minimum permissions.
4. Start a local listener on the attacker machine using netcat: `nc -nlvp 4444`.
5. Execute the provided Python script with the correct arguments:

```bash
python3 MawkiNagiosXIPOC.py <target IP> <Local Listening IP> <NC listening port>
```

## Proof of Concept

The attached Python script demonstrates the vulnerability for review: [MawkNagiosXIPOC.py](MawkNagiosXIPOC.py)

## Recommendation

To mitigate the risk of SQL injection, it is strongly advised to use parameterized queries or prepared statements when interacting with databases. Parameterized queries ensure that user input is treated as data, not executable code, making it much more difficult for attackers to inject malicious SQL statements.

## Supporting Material/References

Refer to the attached PDF for screenshots: [MawkNagiosXIPOC.pdf](MawkNagiosXIPOC.pdf)

---

Feel free to review the provided PoC and recommendations. If you have any questions or concerns, please don't hesitate to open an issue or reach out to the repository maintainers.
